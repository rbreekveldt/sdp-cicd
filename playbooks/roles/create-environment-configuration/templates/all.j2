---
cloud_config:
  project_name: {{ lookup('env', 'project_name') }}
  env_type: {{ lookup('env', 'env_type') }}
  resource_group_phase: {{ lookup('env', 'resource_group_phase') }}
  application_name: {{ lookup('env', 'application_name') }}
  data_domain: {{ lookup('env', 'data_domain') }}

  resource_group: {{ lookup('env', 'data_domain') }}-{{ lookup('env', 'resource_group_phase') }}-{{ lookup('env', 'project_name') }}-{{ lookup('env', 'application_name') }}-{{ lookup('env', 'env_type') }}-rg
  location: "westeurope"
  admin_username: "sdp-admin"

  mockup:
    kafka:
      provision: {{ lookup('env', 'kafka') }}
      functionality: kafka
    sftp:
      provision: {{ lookup('env', 'kafka') }}
      functionality: sftp
    nodes_count: 1
    flavor: Standard_D3_v2

  mgmt:
    provision: {{ lookup('env', 'nifi') }}
    functionality: nifimgmt
    nodes_count: 1
    flavor: Standard_D3_v2

  nifi:
    provision: {{ lookup('env', 'nifi') }}
    functionality: nifi
    nodes_count: {{ lookup('env', 'nifi_nodes_count') }}
    flavor: Standard_A5

  ssh:
    sdp_admin_publickey: {{ sdp_admin_public }}
    jenkins_publickey: {{ jenkins_public }}

        
  storage_account:
    name: sa{{ lookup('env', 'project_name') }}{{ lookup('env', 'application_name') }}{{ lookup('env', 'env_type') }}
    type: "Standard_LRS"
      
  network:
    name: vnet-{{ lookup('env', 'project_name') }}-{{ lookup('env', 'env_type') }}

    address_prefix: "VNET-ANCOR.0/24"
      
  subnet:
    name: subnet-{{ lookup('env', 'project_name') }}-{{ lookup('env', 'env_type') }}
    address_prefix: "VNET-ANCOR.0/26"
      
  security_groups:
    name: nsg-{{ lookup('env', 'project_name') }}-{{ lookup('env', 'env_type') }}
    rules:
      inbound:
        allow_ssh_inbound:
          name: Allow_SSH
          protocol: Tcp
          port: 22
          priority: 100
          source: VirtualNetwork
          destination: VirtualNetwork
        allow_ping_inbound:  
          name: Allow_Ping
          protocol: Udp
          port: 7
          priority: 101
          source: VirtualNetwork
          destination: VirtualNetwork
        allow_icmp_inbound:
          name: Allow_Icmp
          protocol: Icmp
          priority: 102
          source: VirtualNetwork
          destination: VirtualNetwork
      
  peering:
    initial_peering_name: vnet-{{ lookup('env', 'project_name') }}-{{ lookup('env', 'env_type') }}-to-vnet-sdp-internal
    access_virtual_network: '/subscriptions/dd10eed9-865c-4bfa-a260-d3e8fe16b047/resourceGroups/access-sdp-jumpbox-rg/providers/Microsoft.Network/virtualNetworks/vnet-sdp-internal'
    access_resource_group: 'access-sdp-jumpbox-rg'
    access_subscription_id: 'dd10eed9-865c-4bfa-a260-d3e8fe16b047'
    connect_peering_name: vnet-sdp-internal-to-vnet-{{ lookup('env', 'project_name') }}-{{ lookup('env', 'env_type') }}

  vm:
    managed_disk_type: Standard_LRS
    image:
      offer: CentOS
      publisher: OpenLogic
      sku: '7.4'
      version: latest
